# 作業日誌

- まずは、dockerの環境構築
    - wsl2と統合したdocker desktopをインストール
    - そうすれば普通にwsl側でdockerが動く
- grafanaはdocker hubに公式のイメージが上がってるので、それをrunするだけ
    - 初回はhubからダウンロードされる
    - port番号の指定だけすればOK
- 指定したポート番号にlocalhostでブラウザからアクセスすればgrafanaの画面が出てくる
    - この画面でdashboardの設定やdbの設定を行う
- influx dbについても同様にこうしきのdocker imageがあるのでそれを落としてrunすれば動く
    - 指定した番号にブラウザからアクセスすれば初期設定などをする画面になる
- 設定してもろもろやればgrafanaもinflux dbも単体では動く
    - 問題は両社の接続がうまくいかないこと
    - ともにwsl上で動いているのが原因っぽい
    - 同様の報告が上がっている
    - firewall関連なのかなあ？と思いつつ、確認してもよくわからない
- useを考えると、データのuploadはクラウドにして、各自がlocalのPCでアクセスできる方がうれしい
    - 最終的にはgrafanaもサーバ上で動かしてインターネットがあればどこでもテレメを見れる環境が理想だが、これはとりあえずいいや
    - ということで、influxdb cloudとローカルのgrafanaを接続させたい！というのが当面の目標となった
    - 同時に、ラズパイorESPでUARTを読み取ってcloud上のdbにupする、というのもやりたい
- 最終的には、Loraモジュールの刺さったESPorRaspiをネットにつなげて、逐次受け取ったデータをdbにupし、それを各自がgrafanaで閲覧する、というのがベスト
- influxdb cloudを試した
    - 基本的にはlocalhostと変わらない 30日でデータが消える仕様であればタダで利用可能
    - しかしながらgrafanaくんからアクセスが出来ない
    - influxの設定がおかしいのか、wsl上のgrafanaがアクセスを拒まれているのか
    - どっちなのかがいまいち自信がない
    - とにかくまいった

### docker
- カーネル上で動作する
- カーネルを共有し、複数の仮想マシンが動いているように見せる
- カーネルはlinuxカーネルに限定　それによりハイパーバイザ型やホストマシン型仮想マシンと比較して軽量
- wsl2はlinuxカーネルで動作するのでdockerも動く
    - wsl1はシステムコールを翻訳してwindowsカーネルで動くからdocker非対応
- 一応decktopを使わないでwsl2上でdockerを構築することも可能らしい
    - 商用利用のときぐらいしかこういうケースはない